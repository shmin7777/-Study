엔지니어가 개발 환경을 만들어 제공하면 사용자(개발자)는 그에 맞는 도구를 모두 설치해야 했던 온프레미스(on-premises)환경에서  
이미 구성된 환경을 사용자가 필요에 따라 선택하고 조합해서 사용할 수 있게 제공되는  
<b>서비스로서의 인프라 환경(IaaS, Infrastructure as a Service)</b>으로 변화 한다.  
<hr>

# 컨테이너 인프라 환경이란
컨테이너 인프라 환경은 컨테이너를 중심으로 구성된 인프라 환경이다.  
<b>컨테이너(container)</b>는 하나의 운영 체제 커널에서 다른 프로세스에 영향을 받지 않고 독립적으로 실행되는 프로세스 상태를 의미함.  
컨테이너는 가상화 상태(VM)에서 동작하는 프로세스보다 가볍고 빠르게 동작함.  

## 모놀리식 아키텍처
모놀리식 아키텍처(monolithic architecture)는 하나의 큰 목적이 있는 서비스 또는 애플리케이션에 여러 기능이 통합돼 있는 구조  
* 초기 단계에서 설계하기 용이
* 개발이 좀 더 단순하고 코드 관리가 간편
* 서비스 간의 관계가 매우 복잡 

수정이 많을 경우, 다른 서비스에 영향을 미칠 가능성 큼,  
하나의 서비스가 사용량이 증가해 서버를 증가할 경우 다른 서비스들이 포함된 애플리케이션까지 확장하는 것은 비효율적.  

==> 마이크로서비스 아키텍처가 등장

## 마이크로서비스 아키텍처
마이크로서비스 아키텍처(MSA, Microservices Architecture)는 시스템 전체가 하나의 목적을 지향하는 바는 모놀리식 아키텍처와 동일하지만,  
<b>개별 기능을 하는 작은 서비스를 각각 개발</b>해 연결함.  

* 서비스를 재사용하기 쉬움
* 서비스 수정시, 다른 서비스에 영향을 미칠 가능성 줄어듬
* 사용량의 변화에 따라 특정 서비스만 확장 가능.
* 사용자의 요구 사항에 따라 가용성을 즉각적으로 확보해야 하는 IaaS환경에 적합
* 복잡도가 높음
* 서비스가 서로 유기적으로 통신하는 구조로 설계되어 있어, 네트워크를 통한 호출 횟수가 증가해 성능에 영향을 줄 수 있음

마이크로서비스 아키텍처 구성 예시  
![image](https://user-images.githubusercontent.com/67637716/153879169-b164e6ab-3440-4fec-ad34-46cf533ed06a.png)

* 각 서비스와 관련된 기능과 데이터베이스를 독립적으로 가지는 구조로 표현  
* 각 서비스는 API 게이트웨이와 REST API를 이용한 통신 방식으로 사용자의 요청을 전달.  
* 서비스 개수는 고정된 것이 아니기 때문에 어떤 서비스가 등록돼 있는지 파악하기 위해 서비스 디스커버리를 사용.  
* 수많은 서비스의 내부 통신을 이벤트로 일원화하고 효과적으로 관리하기 위해 이벤트 버스를 서비스로 구성.

MSA의 핵심 초점은 시스템 간 다양한 통신 기술을 사용하는 상호 운용성이다.  
상호 운용성을 얻는 가장 좋은 방법은 <b>메시지를 기반으로 통신</b>하는 것.  

마이크로서비스는 일반적으로 이벤트-주도 아키텍처로 구축된다.  
![image](https://user-images.githubusercontent.com/67637716/154007476-39e68917-9c02-40bb-ac89-dfc7856e8ba4.png)

※ API 게이트웨이 : 서비스로 전달하는 모든 API요청의 관문(Gateway)역할을 하는 서버, 시스템의 아키텍처를 내부로 숨기고 외부의 요청에 대한 응답만을 적절한 형태로 응답.  
- 클라이언트의 요청을 일괄적으로 처리
- 전체 시스템의 부하를 분산 시키는 로드 밸런서의 역할
- 동일한 요청에 대한 불필요한 반복작업을 줄일 수 있는 캐싱
- 시스템상을 오고가는 요청과 응답에 대한 모니터링
- 시스템 내부에 아키텍처를 숨길 수 있음.

※ 이벤트 버스 : 앱 내부에서 컴포넌트 사이아 부모 자식 사이에 데이터를 주고 받을 수 있는 방법   

이런 구조 덕분에 각 서비스는 필요한 기능이 특화된 데이터베이스를 선택해 개별 서비스에 할당할 수 있음.  
각 서비스는 독립적으로 동작할 수 있는 완결된 구조라서 이미 개발된 기능이 다른 서비스에 필요하다면 바로 재사용할 수 있음.  

### 컨테이너 인프라 환경은 마이크로서비스 아키텍처로 구현하기에 적합!
컨테이너 인프라 환경에서는 컨테이너를 서비스 단위로 포장해 손쉽게 배포하고 확장할 수 있음.  
컨테이너는 마이크로서비스 아키텍처의 서비스와 1:1로 완벽하게 대응하하며, 도입, 설계, 운용 비용이 감소하고 생산성 향상.  

## 컨테이너 인프라 환경을 지원하는 도구
컨테이너 인프라 환경은 크게 <b>컨테이너, 컨테이너 관리, 개발 환경 구성 및 배포 자동화, 모니터링</b>으로 구성.  

### 도커 : 컨테이너
도커(Docker)는 컨테이너 환경에서 독립적으로 애플리케이션을 실행할 수 있도록 컨테이너를 만들고 관리하는 것을 도와주는 컨테이너 도구
도커로 애플리케이션을 실행하면 <b>운영 체제환경에 관계없이 독립적인 환경에서 일관된 결과를 보장</b>  

### 쿠버네티스 : 컨테이너 관리
쿠버네티스(Kubernetes)는 다수의 컨테이너(Docker)를 관리하는 데 사용.  
컨테이너 인프라 필요한 기능을 통합하고 관리하는 솔루션으로 발전.  
API 게이트웨이, 서비스 디스커버리, 이벤트 버스, 인증 및 결제 등의 다양한 서비스를 효과적으로 관리할 수 있는 환경을 제공하고, 내외부와 유연하게 연결해 줌.  

### 젠킨스 : 개발 환경 구성 및 배포 자동화
젠킨스(Jenkins)는 지속적 통합(CI, Continuous Integration)과 지속적 배포(CD, Continuous Deployment)를 지원.  
CI, CD는 개발한 프로그램의 빌드, 테스트, 패키지화, 배포 단계를 모두 자동화해 개발 단계를 표준화함.  
개발된 코드의 빠른 적용과 효과적인 관리를 통해 개발 생산성을 높이는 데 초점.  
컨테이너 인프라 환경처럼 단일 기능을 빠르게 개발해 적용해야 하는 환경에 매우 적합.  

### 프로메테우스와 그라파나 : 모니터링
프로메테우스(Prometheus)와 그라파나(Grafana)는 모니터링을 위한 도구  
프로메테우스는 상태 데이터를 수집하고, 그라파나는 프로메테우스로 수집한 데이터를 관리자가 보기 좋게 시각화함.  
컨테이너 인프라 환경에서는 많은 종류의 소규모 기능이 각각 나누어 개발되기 때문에 중앙 모니터링이 필요.  
프로메테우스와 그라파나는 컨테이너로 패키징돼 동작하며 최소한의 자원으로 쿠버네티스 클러스터의 상태를 시각적으로 표현.  

![image](https://user-images.githubusercontent.com/67637716/153882911-20dabc50-502b-40cb-8f74-0473ed42c71a.png)


